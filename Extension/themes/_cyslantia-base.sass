$directory: "chrome-extension://__MSG_@@extension_id__/themes"

$author: "Brad in Dvorak" !default
$title: "Cyslantia" !default
$version: "2.0" !default

// Version info

/*! #{$title}, version #{$version} by #{$author} !

// Initialize variables

$color-background-page: null !default
$color-background-header: null !default
$color-background-navbar: null !default
$color-background-main: null !default
$color-background-sidebar: null !default
$color-background-accent: null !default

$color-text-header: null !default
$color-text-navbar: null !default
$color-text-heading: null !default
$color-text-main: null !default
$color-text-sidebar: null !default
$color-text-link: null !default
$color-text-link-hover: null !default

$font-header: "Playfair Display", serif !default
$font-main: "Route 159", Ubuntu, "Trebuchet MS", sans-serif !default
$font-monospace: "Fira Code", "Fira Mono", monospace !default
$font-size-main: 14px !default

$image-background-page: url("#{$directory}/images/cys-banner-baked.svg") !default
$image-background-underside: url("#{$directory}/images/cys-corner.svg") !default
$image-background-header: url("#{$directory}/images/cys-header.png") !default
$image-background-header-2: url("#{$directory}/images/cys-header-2x.png") !default

$image-icon-featured: url("#{$directory}/images/elusive/star-alt.svg") !default
$image-icon-search: url("#{$directory}/images/elusive/search.svg") !default
$image-icon-eye: url("#{$directory}/images/elusive/eye-open.svg") !default
$image-icon-eye-closed: url("#{$directory}/images/elusive/eye-close.svg") !default
$image-icon-threaded: url("#{$directory}/images/elusive/align-left.svg") !default
$image-icon-unthreaded: url("#{$directory}/images/elusive/align-justify.svg") !default
$image-icon-reply: url("#{$directory}/images/elusive/share-alt.svg") !default
$image-icon-edit: url("#{$directory}/images/elusive/pencil.svg") !default
$image-icon-minus: url("#{$directory}/images/elusive/minus.svg") !default
$image-icon-plus: url("#{$directory}/images/elusive/plus.svg") !default
$image-icon-bug: url("#{$directory}/images/elusive/bug.png") !default
$image-icon-squashed-bug: url("#{$directory}/images/elusive/squashedbug.png") !default
$image-icon-tag: url("#{$directory}/images/elusive/tag.svg") !default
$image-icon-exclaim: url("#{$directory}/images/elusive/exclaim.png") !default
$image-icon-edit-adv: url("#{$directory}/images/elusive/file-edit.svg") !default
$image-icon-delete: url("#{$directory}/images/elusive/remove.svg") !default
$image-icon-go: url("#{$directory}/images/elusive/arrow-right.svg") !default
$image-icon-stop: url("#{$directory}/images/elusive/stop-alt.svg") !default
$image-icon-item: url("#{$directory}/images/elusive/gift.svg") !default
$image-icon-variable: url("#{$directory}/images/percent.svg") !default
$image-icon-script: url("#{$directory}/images/elusive/file.svg") !default

@function specular-gradient($w, $x)
  @return radial-gradient(circle $w at $x 0%, rgba(white, 0.1), rgba(white, 0))

@import cyslantia-fonts

// Basic body stuff first

html, body
  min-height: 100vh

html
  background: $color-background-page $image-background-page repeat-x

  &[dir="ltr"]
    background: unset

body
  background-color: $color-background-page
  box-sizing: border-box
  color: $color-text-main
  font-family: $font-main
  font-size: $font-size-main !important
  position: relative
  z-index: -2

  &.cke_editable
    background-color: #FFFAEF

  &:not(.cke_editable)
    margin: 0

  > table:first-child
    padding: 8px

// Header area

#HeaderContainer
  background-color: $color-background-header
  background: $image-background-header top center no-repeat, specular-gradient(360px, 33.33%), $color-background-header
  background: -webkit-image-set($image-background-header 1x, $image-background-header-2 2x) top center no-repeat, specular-gradient(360px, 33.33%), $color-background-header
  height: 130px
  z-index: -1

  .header-alerts-container
    margin: 0 !important
    left: 50%
    transform: translateX(-50%)
    bottom: 10px
    background-color: #F5F0E4 !important

    &.newmessage
      border: 1px solid #530703 !important

  .header-contents
    height: 120px !important
    margin: auto
    position: relative
    z-index: -1

    .header-logo
      img
        height: 120px
        opacity: 0
        display: none

      a::after
        color: $color-text-header
        content: "chooseyourstory.com"
        font-size: 30pt
        font-family: $font-header
        font-weight: bold
        left: -40px
        line-height: 120px
        position: absolute
        top: 0

// Body area

#BodyContainer
  width: unset
  max-width: 960px
  margin: 0 auto !important
  box-shadow: 0 2px 10px rgba(black, 0.35)
  position: static !important
  isolation: isolate

  // Navbar

  .sidebar-content
    border-top: 1px solid #530703
    box-sizing: border-box
    padding: 0 !important
    top: 130px !important
    width: 100%

    > ul
      margin: 0 auto !important
      max-width: 978px
      height: 48px
      box-sizing: border-box
      padding: 10px 5px !important
      box-shadow: 0 3px 8px rgba(black, 0.4), inset 0 1px rgba(white, 0.2)
      position: relative
      top: -10px
      background-color: #871D18
      border-top: 1px solid #530703
      background: specular-gradient(360px, 33.33%), #871D18
      z-index: 2
      display: flex
      flex-direction: row
      justify-content: space-between
      align-items: stretch

      > li
        display: inline-flex
        position: relative
        height: 100%
        margin-bottom: 10px
        flex: 1 0 auto

        a
          font-family: $font-header

          //font-variant: small-caps //using font-weight: 500
          padding: 0 20px
          color: $color-text-navbar !important
          text-shadow: 0 1px 0 rgba(black, 0.8)
          font-weight: 500
          border-right: 1px solid rgba(white, 0.15)
          white-space: nowrap
          transition: text-shadow 0.33s ease
          text-align: center
          width: 100%

          &:hover, &.selected
            text-shadow: 0 0 20px rgba(white, 0.9)

          &[data-badge]::after
            content: attr(data-badge)
            position: absolute
            bottom: 100%
            font-family: $font-main
            right: 0
            width: 1.75em
            height: 1.75em
            background-color: #591414
            border-radius: 1.75em
            line-height: 1.75em
            text-align: center
            font-weight: bold
            font-size: 0.6em
            left: 0
            margin: auto
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), inset 0 1px rgba(255, 255, 255, 0.2)

        &:last-of-type a
          border-right: none

        > ul
          position: absolute
          top: 100%
          padding-top: 10px
          background-color: #6F231F
          background-clip: content-box
          visibility: hidden
          opacity: 0
          transition: opacity 0.33s ease
          min-width: 100%
          z-index: 1

          > li
            display: block
            margin: 0
            width: 100%

            a
              border-bottom: 1px solid rgba(black, 0.2)
              border-right: none
              display: block
              font-weight: 400
              margin: 0 20px
              padding: 4px 0
              position: relative
              text-align: left
              width: auto

              &[data-badge]::after
                content: attr(data-badge)
                position: absolute
                font-family: $font-main
                left: 100%
                width: 1.75em
                height: 1.75em
                background-color: #591414
                border-radius: 1.75em
                line-height: 1.75em
                text-align: center
                font-weight: bold
                font-size: 0.6em
                top: 50%
                transform: translateY(-50%)
                margin: auto
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), inset 0 1px rgba(255, 255, 255, 0.2)

        &:hover > ul
          visibility: visible
          opacity: 1

    &::after
      background-color: #871D18
      border-top: 1px solid rgba(white, 0.2)
      box-sizing: border-box
      bottom: 0
      content: " "
      height: 100%
      position: absolute
      width: 100%
      z-index: -1

  > .main-content
    &, .footer-content
      background-color: $color-background-main !important
      border-color: #BBB !important
      margin: 38px auto 0 !important
      position: relative

    &::before, &::after
      content: " "
      height: 6px
      width: 9px
      background-image: $image-background-underside
      position: absolute
      top: 0
      z-index: 1

    &::before
      left: -10px
      transform: scaleX(-1)

    &::after
      right: -10px

  > .footer-content
    margin: 0 !important

  // Extras for certain pages and the CKEditor

  &:not(.fixed-width-container)
    box-shadow: none
    height: 100vh

    > .main-content
      background-color: transparent !important
      box-sizing: border-box
      height: 100%
      margin: 0 !important
      padding: 10px

      &::before
        content: none

      table
        background-color: #F5F0E4

        tr:nth-of-type(2n+1)
          background-color: #EAE2CE !important

        + .button
          display: none

// Navbar

.sidebar-content

// General main stuff

h1, h2, h3, h1 a
  color: $color-text-heading
  font-family: $font-header

a
  color: $color-text-link

  &:hover
    color: $color-text-link-hover
    text-decoration: underline

code, kbd, samp
  font-family: $font-monospace

code
  font-variant-ligatures: no-contextual

kbd, samp
  font-variant-ligatures: no-contextual

hr
  background-color: $color-background-accent
  border: none
  border-radius: none
  height: 1px
  margin: 0.5em 2px

// Storygame sections
img[src$="CYS/images/star.gif"]
  content: $image-icon-featured
  vertical-align: text-bottom

// Storygame description page
img[src$="16x16/star.png"]
  content: $image-icon-featured

// Forums

a.button, a.button:active
  display: inline-block
  color: rgb(221, 221, 221)
  background-color: #3F1A18
  background-image: unset
  border: medium none rgb(221, 221, 221)
  font-size: 80%
  height: 14px
  line-height: 14px
  padding: 3px 4px

  > img
    height: 100%
    margin-top: 0

    &[src$="magnifier.png"]
      content: $image-icon-search

    &[src$="note_add.png"]
      content: $image-icon-plus

    &[src$="eye.png"]
      content: $image-icon-eye

    &[src$="stop.png"]
      content: $image-icon-eye-closed

    &[src$="application_tile_vertical.png"]
      content: $image-icon-unthreaded

    &[src$="application_cascade.png"]
      content: $image-icon-threaded

    &[src$="note_go.png"]
      content: $image-icon-reply

    &[src$="note_edit.png"]
      content: $image-icon-edit

    &[src$="tag_green.png"]
      content: $image-icon-tag

.forum-thread.collapsed a.button.collapse > img
  content: $image-icon-plus

.styled-table
  img
    &[src$="bug.gif"]
      content: $image-icon-bug

    &[src$="squashedbug.gif"]
      content: $image-icon-squashed-bug

// Profiles

#profile_Text > img:first-child
  image-rendering: -webkit-crisp-edges
  image-rendering: -moz-crisp-edges
  image-rendering: -o-crisp-edges
  image-rendering: crisp-edges
  image-rendering: pixelated
  min-width: 100px !important

#profile_Sidebar
  box-shadow: 0 3px 8px rgba(black, 0.4)
  margin-right: -20px
  margin-left: 10px
  background-color: $color-background-sidebar !important
  border: 1px solid #998D4E
  color: $color-text-sidebar
  position: relative
  width: 170px !important
  background: specular-gradient(360px, 0% 0%), #B7A374

  h2
    color: #201A1A
    margin-top: 5px !important

  > div
    border-bottom: 1px solid rgba(white, 0.15)
    padding-bottom: 5px
    margin: 0 10px 0

  &:last-of-type, + div
    border-bottom: none
    padding-bottom: 0

  a
    color: #EEE !important
    text-shadow: 0 1px 0 rgba(black, 0.8)
    text-decoration: none
    transition: text-shadow 0.33s ease

    &:hover
      text-shadow: 0 0 20px rgba(white, 0.9)

  &::after
    content: " "
    height: 6px
    width: 9px
    background: $image-background-underside no-repeat
    position: absolute
    top: 100%
    right: -1px
    z-index: -1

.alternate
  text-align: center
  border: 1px solid #871D18 !important
  margin: 15px -20px 5px !important
  box-shadow: 0 3px 8px rgba(black, 0.4)
  position: relative

  &::before, &::after
    content: " "
    height: 6px
    width: 9px
    background-image: $image-background-underside
    position: absolute
    top: 100%
    z-index: -1

  &::before
    left: 0
    transform: scaleX(-1)

  &::after
    right: 0

#profile_Trophies
  padding: 10px 0
  width: 550px

  h2
    margin-left: 2px

#profile_Articles, #profile_Posts, #profile_Stories
  clear: both

  hr
    clear: both

    &:last-child
      display: none

#profile_Articles, #profile_Posts
  > div
    *
      font-size: inherit

    a
      display: inline
      font-weight: unset

#profile_Stories
  > div + div
    *
      font-size: inherit

    a
      display: inline
      font-weight: unset

  .unpublished a
    display: inline
    font-style: italic

// Storygame description page

// Storygame rating container

.ui-widget.ui-widget-content
  font-family: $font-header
  box-shadow: 0 3px 8px rgba(black, 0.4)
  border-radius: 0
  background-color: #BCAE8E !important
  border: 1px solid #998D4E
  background: specular-gradient(360px, 0%), #B7A374

.ui-dialog-titlebar
  background-color: transparent
  background-image: none
  border: none
  border-radius: 0

.ui-widget-overlay.ui-front
  backdrop-filter: blur(3px)
  -webkit-backdrop-filter: blur(3px)
  background: rgba(grey, 0.4)
  opacity: 1

// Footer area
#Footer
  margin-bottom: 0
  margin-left: auto
  margin-right: auto
  padding-bottom: 10px
  text-align: center

// Advanced Editor
img[src$="exclaim.gif"]
  content: $image-icon-exclaim

img[src$="edit.gif"]
  content: $image-icon-edit-adv

img[src$="script.gif"], img[src$="script_dim.gif"]
  content: $image-icon-script

img[src$="delete.gif"]
  content: $image-icon-delete

img[src$="go.gif"]
  content: $image-icon-go

img[src$="stop.gif"], img[src$="stop_dim.gif"]
  content: $image-icon-stop

img[src$="item.gif"], img[src$="item_dim.gif"]
  content: $image-icon-item

img[src$="addsub.gif"], img[src$="addsub_dim.gif"]
  content: $image-icon-variable

img[src$="_dim.gif"]
  filter: saturate(0.8) opacity(0.6)

// Script editor
body[onload*="ScriptText"]
  padding: 0 !important

  > form
    box-sizing: border-box
    display: flex
    flex-direction: column
    height: 100%
    margin: 0
    padding: 20px

    > table
      margin-bottom: 0.5em

    > .CodeMirror
      flex: 1 0

//Page editor
form[name="mainForm"]
  > div
    box-sizing: border-box
    display: flex
    flex-direction: column
    min-height: 100vh
    margin: 0
    padding: 20px

    > p
      background-color: #28211c
      flex: 1 1 50vh
      min-height: 180px
      overflow: auto

      > .CodeMirror
        height: 100%
